{"version":3,"sources":["admin.js"],"names":["Admin","constructor","focused","elements","initElements","initHeader","header","document","querySelector","toggle_button","content","page_select","getElementById","addEventListener","e","classList","toggle","preventDefault","new_url","options","selectedIndex","getAttribute","location","pathname","href","self","editable_items","forEach","selector","items","querySelectorAll","length","element","id","item","key","value","textContent","trim","el","style","cursor","focusElement","stopImmediatePropagation","stopPropagation","kc","keyCode","which","metaKey","blur","saveElement","push","showMsg","updateElement","name","csrf_token","page_id","data","FormData","set","axios","method","url","headers","then","res","catch","err","console","error","cur_item","backgroundColor","color","contentEditable","focus","innerText","result","log","msg","notification","createElement","add","innerHTML","body","appendChild","setTimeout","window","admin"],"mappings":"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","sourcesContent":["class Admin {\r\n    constructor() {\r\n        this.focused = null\r\n        this.elements = []\r\n        this.initElements()\r\n        this.initHeader()\r\n    }\r\n\r\n    initHeader() {\r\n        const header = document.querySelector('.admin-header')\r\n        const toggle_button = header.querySelector('.toggle-page-content')\r\n        const content = header.querySelector('.page-content')\r\n        const page_select = document.getElementById('page')\r\n        toggle_button.addEventListener('click', e => {\r\n            content.classList.toggle('collapse')\r\n            e.preventDefault()\r\n        })\r\n        page_select.addEventListener('change', e => {\r\n            const new_url = page_select.options[page_select.selectedIndex].getAttribute('data-url')\r\n            if (new_url != location.pathname) {\r\n                location.href = new_url\r\n            }\r\n        })\r\n    }\r\n\r\n    initElements() {\r\n        const self = this\r\n        const editable_items = [\r\n            '.main-nav a', '.header .cta-wrapper > *', '.hero .info > *',\r\n            '.cta .swf > *', '.cfj .about > *', '.cfj .link',\r\n            '.zuu .about > *', '.zuu .link', '.about .inner > *',\r\n            '.map .inner > *', '.footer-nav a', '.services .swf > *',\r\n            '.services .swf > div p'\r\n        ]\r\n        editable_items.forEach(selector => {\r\n            let items = document.querySelectorAll(selector)\r\n            if (items.length) {\r\n                items.forEach(element => {\r\n                    if (!element.id) {\r\n                        return\r\n                    }\r\n                    let item = {\r\n                        key: element.id,\r\n                        value: element.textContent.trim(),\r\n                        el: element\r\n                    }\r\n                    element.style.cursor = 'cell'\r\n                    element.addEventListener('click', e => {\r\n                        self.focusElement(item)\r\n                        e.preventDefault()\r\n                        e.stopImmediatePropagation()\r\n                        e.stopPropagation()\r\n                        return false\r\n                    })\r\n                    element.addEventListener('keydown', e => {\r\n                        let kc = e.keyCode ? e.keyCode : e.which;\r\n                        if (e.metaKey && kc == 13) {\r\n                            element.blur()\r\n                        }\r\n                    })\r\n                    element.addEventListener('blur', e => {\r\n                        self.saveElement(item)\r\n                    })\r\n                    self.elements.push(item)\r\n                })\r\n            }\r\n        })\r\n        this.showMsg('Editing tools ready! ヽ(´▽`)/')\r\n    }\r\n\r\n    updateElement(name, value) {\r\n        const csrf_token = document.querySelector('meta[name=csrf-token]')\r\n        const page_id = document.getElementById('page').value\r\n        let data = new FormData\r\n        data.set(name, value)\r\n        data.set('page', page_id)\r\n        return axios({\r\n            method: 'post',\r\n            url: '/update.php',\r\n            data: data,\r\n            headers: {\r\n                'x-requested-with': 'XMLHttpRequest',\r\n                'x-csrf-token': csrf_token.content,\r\n                'Content-Type': 'multipart/form-data',\r\n            }\r\n        })\r\n            .then(res => res.data)\r\n            .catch(err => console.error(err))\r\n    }\r\n\r\n    focusElement(cur_item) {\r\n        this.focused = cur_item\r\n        this.elements.forEach(item => {\r\n            if (item != cur_item) {\r\n                item.el.style.backgroundColor = ''\r\n                item.el.style.color = ''\r\n                item.el.contentEditable = false\r\n            }\r\n        })\r\n        cur_item.el.style.backgroundColor = '#138771'\r\n        cur_item.el.style.color = '#2C3539'\r\n        cur_item.el.contentEditable = true\r\n        cur_item.el.focus()\r\n    }\r\n\r\n    saveElement(item) {\r\n        this.updateElement(item.key, item.el.innerText.trim()).then(result => {\r\n            if (result == 'success') {\r\n                item.el.style.backgroundColor = ''\r\n                item.el.style.color = ''\r\n                item.el.contentEditable = false\r\n            } else {\r\n                console.log(result)\r\n            }\r\n        })\r\n    }\r\n\r\n    showMsg(msg) {\r\n        const notification = document.createElement('div')\r\n        notification.classList.add('notify')\r\n        notification.innerHTML = msg\r\n        document.body.appendChild(notification)\r\n        setTimeout(() => {\r\n            notification.classList.add('hide')\r\n        }, 6000)\r\n    }\r\n}\r\n\r\nwindow.admin = new Admin\r\n"],"file":"admin.js"}